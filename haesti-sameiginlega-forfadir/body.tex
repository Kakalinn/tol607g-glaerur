\title{Hæsti sameiginlegi forfaðir}
\author{Bergur Snorrason}
\date{\today}

\begin{document}

\frame{\titlepage}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Gerum ráð fyrir að við séum með tré.
		\item<2-> Látum einn hnút tákna rót trésins.
		\item<3-> Við getum þá talað um \emph{hæð} hnúts í trénu.
		\item<4-> Hæðin er þá fjarlægðin frá hnútnum í rótina.
		\item<5-> Þar sem við erum í tréi er aðeins einn einfaldur vegur í rótina.
		\item<6-> Ein leið til að finna hæð allra hnúta er með einni dýptarleit.
		\item<7-> Látum hæð hnútsins $u$ vera $h(u)$.
		\item<8-> Við segjum líka að hæð trés sé $H$ ef hnúturinn með hæstu hæð er $H$.
	}
}

\env{frame}
{
	\only<1->
	{
		\env{tikzpicture}
		{
			\only<1-> { \node[white] at (9,-5) {.}; }
			\only<1-> { \node[white] at (9,5) {.}; }
			\only<1-> { \node[white] at (-2,-5) {.}; }
			\only<1-> { \node[white] at (-2,5) {.}; }
			\only<1-4> { \node[draw, circle, thick] (1) at (0,0) {\phantom{xx}}; }
			\only<5-> { \node[draw, circle, thick] (1) at (1,1) {\phantom{xx}}; }

			\only<1-3> { \node[draw, circle, thick] (2) at (0,2) {\phantom{xx}}; }
			\only<4-> { \node[draw, circle, thick] (2) at (1,-1) {\phantom{xx}}; }

			\only<1-5> { \node[draw, circle, thick] (3) at (0,-2) {\phantom{xx}}; }
			\only<6-> { \node[draw, circle, thick] (3) at (1,3) {\phantom{xx}}; }

			\only<1> { \node[draw, circle, thick] (4) at (2,1) {\phantom{xx}}; }
			\only<2> { \node[draw, circle, thick, blue] (4) at (2,1) {\phantom{xx}}; }
			\only<3-> { \node[draw, circle, thick, blue] (4) at (3,-3) {\phantom{xx}}; }

			\only<1-6> { \node[draw, circle, thick] (5) at (2,-1) {\phantom{xx}}; }
			\only<7-> { \node[draw, circle, thick] (5) at (3,-1) {\phantom{xx}}; }

			\only<1-7> { \node[draw, circle, thick] (6) at (4,0) {\phantom{xx}}; }
			\only<8-> { \node[draw, circle, thick] (6) at (5,-1) {\phantom{xx}}; }

			\only<1-9> { \node[draw, circle, thick] (7) at (4,2) {\phantom{xx}}; }
			\only<10-> { \node[draw, circle, thick] (7) at (4,3) {\phantom{xx}}; }

			\only<1-10> { \node[draw, circle, thick] (8) at (6,-2) {\phantom{xx}}; }
			\only<11-> { \node[draw, circle, thick] (8) at (6,3) {\phantom{xx}}; }

			\only<1-8> { \node[draw, circle, thick] (9) at (6,0) {\phantom{xx}}; }
			\only<9-> { \node[draw, circle, thick] (9) at (5,1) {\phantom{xx}}; }

			\path[draw, thick] (4) -- (2);
			\path[draw, thick] (4) -- (5);
			\path[draw, thick] (4) -- (6);
			\path[draw, thick] (2) -- (1);
			\path[draw, thick] (1) -- (3);
			\path[draw, thick] (6) -- (9);
			\path[draw, thick] (9) -- (7);
			\path[draw, thick] (9) -- (8);

			\only<12-> { \node at (3,-3) {$0$}; }
			\only<13-> { \node at (1,-1) {$1$}; }
			\only<14-> { \node at (1,1) {$2$}; }
			\only<15-> { \node at (1,3) {$3$}; }
			\only<16-> { \node at (3,-1) {$1$}; }
			\only<17-> { \node at (5,-1) {$1$}; }
			\only<18-> { \node at (5,1) {$2$}; }
			\only<19-> { \node at (4,3) {$3$}; }
			\only<20-> { \node at (6,3) {$3$}; }
		}
	}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Við köllum þann nágranna hnúts sem hefur einum lægri hæð \emph{foreldri} hnútsins.
		\item<2-> Við getum þá fundið veginn að rótinni með því að ferðast eftir foreldrum.
		\item<3-> Þeir hnútar sem eru á veginum niður að rótinni kallast \emph{forfeður} hnúts.
		\item<4-> Það er kannski skrýtið, en allir hnútar er forfeður sínir.
		\item<5-> Oft nýtist okkur að vitað hvaða sameiginlegi forfaðir tveggja hnúta er hæstur í trénu.
	}
}

\env{frame}
{
	\only<1->
	{
		\env{tikzpicture}
		{
			\only<1-> { \node[white] at (9,-5) {.}; }
			\only<1-> { \node[white] at (9,5) {.}; }
			\only<1-> { \node[white] at (-2,-5) {.}; }
			\only<1-> { \node[white] at (-2,5) {.}; }
			\only<1-> { \node[draw, circle, thick] (1) at (1,1) {\phantom{xx}}; }

			\only<1-8, 10> { \node[draw, circle, thick] (2) at (1,-1) {\phantom{xx}}; }
			\only<9> { \node[draw, circle, thick, fill, green] (2) at (1,-1) {\phantom{xx}}; }

			\only<1-> { \node[draw, circle, thick] (3) at (1,3) {\phantom{xx}}; }

			\only<1-5, 7-> { \node[draw, circle, thick] (4) at (3,-3) {\phantom{xx}}; }
			\only<6> { \node[draw, circle, thick, fill, green] (4) at (3,-3) {\phantom{xx}}; }

			\only<1-> { \node[draw, circle, thick] (5) at (3,-1) {\phantom{xx}}; }

			\only<1-> { \node[draw, circle, thick] (6) at (5,-1) {\phantom{xx}}; }

			\only<1-> { \node[draw, circle, thick] (7) at (4,3) {\phantom{xx}}; }

			\only<1-> { \node[draw, circle, thick] (8) at (6,3) {\phantom{xx}}; }

			\only<1-2, 4-> { \node[draw, circle, thick] (9) at (5,1) {\phantom{xx}}; }
			\only<3> { \node[draw, circle, thick, fill, green] (9) at (5,1) {\phantom{xx}}; }

			\path[draw, thick] (4) -- (2);
			\path[draw, thick] (4) -- (5);
			\path[draw, thick] (4) -- (6);
			\path[draw, thick] (2) -- (1);
			\path[draw, thick] (1) -- (3);
			\path[draw, thick] (6) -- (9);
			\path[draw, thick] (9) -- (7);
			\path[draw, thick] (9) -- (8);

			\only<2-3> { \node at (4,3) {$u$}; }
			\only<2-3> { \node at (6,3) {$v$}; }
			\only<5-6> { \node at (6,3) {$v$}; }
			\only<5-6> { \node at (1,-1) {$u$}; }
			\only<8-9> { \node at (1,3) {$u$}; }
			\only<8-9> { \node at (1,-1) {$v$}; }
		}
	}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Hvernig finnum þennan forföður?
		\item<2-> Látum $u$ og $v$ tákna hnútana og $x$ hæsta sameiginlega forföður þeirra.
		\item<3-> Við getum gert ráð fyrir að $u$ sé ofar í trénu, það er að segja $h(u) \geq h(v)$.
		\item<4-> Við vitum að allir forfeður $u$ sem hafa hæð stærri en $d(v)$ eru ekki $x$.
		\item<5-> Svo við getum ferðast niður tréð frá $u$ þar til við erum komin í sömu hæð og $v$.
		\item<6-> Við getum svo ferðast eftir foreldrum beggja á sama tíma þangað til við lendum í sama hnútnum.
		\item<7-> Sá hnútur er $x$.
		\item<8-> Sjáum hvernig þessi aðferð leysir sýnidæmið á undan.
	}
}

\env{frame}
{
	\only<1->
	{
		\env{tikzpicture}
		{
			\only<1-> { \node[white] at (9,-5) {.}; }
			\only<1-> { \node[white] at (9,5) {.}; }
			\only<1-> { \node[white] at (-2,-5) {.}; }
			\only<1-> { \node[white] at (-2,5) {.}; }

			\only<1-> { \node[draw, circle, thick] (1) at (1,1) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (2) at (1,-1) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (3) at (1,3) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (4) at (3,-3) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (5) at (3,-1) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (6) at (5,-1) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (7) at (4,3) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (8) at (6,3) {\phantom{xx}}; }
			\only<1-> { \node[draw, circle, thick] (9) at (5,1) {\phantom{xx}}; }

			\path[draw, thick] (4) -- (2);
			\path[draw, thick] (4) -- (5);
			\path[draw, thick] (4) -- (6);
			\path[draw, thick] (2) -- (1);
			\path[draw, thick] (1) -- (3);
			\path[draw, thick] (6) -- (9);
			\path[draw, thick] (9) -- (7);
			\path[draw, thick] (9) -- (8);

			\only<2-3> { \node at (4,3) {$u$}; }
			\only<2-3> { \node at (6,3) {$v$}; }
			\only<3> { \node at (5,1) {$x$}; }

			\only<5> { \node at (6,3) {$v$}; }
			\only<5> { \node at (1,-1) {$u$}; }
			\only<6-9> { \node at (6,3) {$u$}; }
			\only<6-9> { \node at (1,-1) {$v$}; }
			\only<7> { \node at (5,1) {$x$}; }
			\only<8> { \node at (5,-1) {$x$}; }
			\only<9> { \node at (3,-3) {$x$}; }



			\only<11-13> { \node at (1,3) {$u$}; }
			\only<11-12> { \node at (1,-1) {$v$}; }
			\only<12> { \node at (1,1) {$x$}; }
			\only<13> { \node at (1,-1) {$x$}; }

			\only<15-18> { \node at (1,1) {$v$}; }
			\only<15-18> { \node at (6,3) {$u$}; }
			\only<16> { \node at (5,1) {$x$}; }
			\only<17> { \node at (5,-1) {$x$}; }
			\only<17> { \node at (1,-1) {$x$}; }
			\only<18> { \node at (3,-3) {$x$}; }
		}
	}
}

\env{frame}
{
	\selectcode{code/lca-slow.cpp}{7}{28}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Gerum ráð fyrir að hæð trésins sé $H$.
		\item<2-> Þá er tímaflækjan á þessari aðferð $\mathcal{O}($\onslide<3->{$\,H\,$}$)$.
		\item<4-> Í versta falli er hæð trés með $n$ hnúta \onslide<5->{$n - 1$}.
		\item<6-> Svo tímaflækjan er í versta falli $\mathcal{O}(n)$.
		\item<7-> Við getum þó bætt þetta með því að taka stærri stökk.
	}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Aðferðin skiptist í tvö skref:
		\env{itemize}
		{
			\item<2-> Jöfnum hæðina á hnútunum.
			\item<3-> Löbbum saman niður þangað til við finnum svarið.
		}
		\item<4-> Fyrra skrefinu má lýsa nánar.
		\item<5-> Látum hnútana okkar vera $u$ og $v$, þannig að $d(u) \geq d(v)$.
		\item<6-> Við viljum því ferðast niður nákvæmlega $d(v) - d(u)$ sinnum.
		\item<7-> Ein leið til að gera þetta hratt er að geyma ekki bara foreldri hvers hnúts,
					heldur alla hnúta sem eru $2^k$ fyrir neðan hnútinn í trénu.
		\item<8-> Við þurfum því að geyma $\mathcal{O}($\onslide<9->{$\log n$}$)$ stökk fyrir hvern hnút.
		\item<10-> Táknum með $p(u, k)$ þann hnút sem þú endar í ef þú ferðast $2^k$ sinnum niður tréð frá $u$ gegnum foreldrin.
		\item<11-> Til dæmis er $p(u, 1)$ foreldri $u$.
		\item<12-> Til þæginda segjum við að foreldri rótarinnar sé rótin sjálf.
		\item<13-> Við finnum þessi gildi með $p(u, i) = p(p(u, i - 1), i - 1)$.
	}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Við tökum því eins löng stökk og við getum án þess að $d(u) < d(v)$ þangað til $d(u) = d(v)$.
		\item<2-> Við getum þú núna gert ráð fyrir að $d(u) = d(v)$.
		\item<3-> Þá viljum við taka eins löng stökk og við getum þannig að $u \neq v$.
		\item<4-> Að því loknu munu $u$ og $v$ hafa sama foreldri.
	}
}

\env{frame}
{
	\selectcode{code/lca.cpp}{9}{34}
}

\env{frame}
{
	\env{itemize}
	{
		\item<1-> Í hverju skrefi þurfum við bara að taka $\mathcal{O}($\onslide<2->{$\log n$}$)$.
		\item<3-> Svo tímaflækjan er $\mathcal{O}($\onslide<4->{$\log n$}$)$.
	}
}

\env{frame}
{
}

\end{document}
